--CAU1 A
SELECT HOTEN, CMND 
FROM BENHNHAN
WHERE DOITUONG = 'BHYT' OR DIACHI = 'Đồng Nai'
ORDER BY SLPT DESC

--CAU1 B
SELECT KHAMBENH.MAKB, BENHNHAN.MABN, HOTEN
FROM KHAMBENH, BENHNHAN
WHERE KHAMBENH.MABN = BENHNHAN.MABN
	AND YEAR(NGSINH) > 2020
	AND BENH = 'Tim mạch'

--CAU 1C
SELECT BENHNHAN.MABN, HOTEN, COUNT(*) SL
FROM BENHNHAN, KHAMBENH
WHERE BENHNHAN.MABN = KHAMBENH.MABN
	AND YEAR(NGBD) = 2020
GROUP BY BENHNHAN.MABN, HOTEN	
--CAU 1D
--Bang A:Lấy những bác sĩ chuyên tai mũi họng
--Bang B: Lấy bảng những bác sĩ chuyên tai
-- mũi họng trong năm 2020
--Bang A - Bang B = KQ

SELECT BACSI.MABS, HOTEN
FROM BACSI
WHERE CHUYENMON = 'TAI-MUI-HONG'

EXCEPT

SELECT BACSI.MABS, HOTEN
FROM BACSI, PHUTRACH
WHERE BACSI.MABS = PHUTRACH.MABS
	AND CHUYENMON = 'TAI-MUI-HONG'
	AND YEAR(BATDAUPT) = 2020

--CAU 1E
SELECT BACSI.MABS, BACSI.HOTEN
FROM BACSI, PHUTRACH, KHAMBENH, BENHNHAN
WHERE BACSI.MABS = PHUTRACH.MABS
	AND PHUTRACH.MAKB = KHAMBENH.MAKB
	AND KHAMBENH.MABN = BENHNHAN.MABN
	AND CHUYENMON = 'HOISUC - CAPCUU'
	AND BACSI.HOTEN = 'NGUYEN VAN A'
GROUP BY BACSI.MABS, BACSI.HOTEN
HAVING COUNT(DISTINCT MAKB) = (
			SELECT COUNT(KHAMBENH.MAKB)
			FROM KHAMBENH, BENHNHAN
			WHERE KHAMBENH.MABN = BENHNHAN.MABN
				AND HOTEN = 'NGUYEN VAN A'	
				)

-- CAU 1F
SELECT TOP 1 WITH TIES BACSI.MABS, HOTEN
FROM BACSI, PHUTRACH
WHERE BACSI.MABS = PHUTRACH.MABS
GROUP BY BACSI.MABS, HOTEN
ORDER BY COUNT(*) DESC

--CÂU 1:

--BỐI CẢNH: BENHNHAN, KHAMBENH, PHAUTHUAT

-- NỘI DUNG: 
VỚI MỌI B THUỘC BENHNHAN,
B.SLPT = COUNT(K THUỘC KHAMBENH, P THUỘC PHAUTHUAT :
		B.MABN = K.MABN ^ K.MAKB = P.MAKB)(P.MAPT)


-- BẢNG TẦM ẢNH HƯỞNG
		THÊM		XÓA		SỬA
BENHNHAN	 -		 -		+(SLPT)
KHAMBENH	 -		 - 		+(MABN)
PHAUTHUAT	 +		 +		+(MAKB)



--2.1
ĐỂ BIẾT BDC -->E CÓ THUỘC F+ KHÔNG 
TA CẦN CHỨNG MINH E THUỘC BDC+F HAY KHÔNG

TA CÓ:  BDC+F := BDC
	BDC+F := BDCA(DO BC-->AD)	
	BDC+F := BDCAE(DO A-->E) = Q+
KẾT LUẬN: VÌ E THUỘC BDC+F NÊN BDC-->E THUỘC F+
--2.2
TẬP THUỘC TÍNH NGUỒN: N={RỖNG}
TẬP THUỘC TÍNH ĐÍCH: Đ ={D,E}
TẬP THUỘC TÍNH TRUNG GIAN: TG={A,B,C}

TA CÓ N+F = {RỖNG}

LIỆT KÊ MỌI TẬP CON CỦA TẬP TG(TGi):
{A,B,C,AB,AC,BC,ABC}

A+ = ABCDE = Q+ => A LÀ KHÓA, LOẠI TẬP CON TGi CHỨA A: AB,AC,ABC
B+ = B KHÁC Q+ => B KHÔNG PHẢI LÀ KHÓA
C+ = C KHÁC Q+ => C KHÔNG PHẢI LÀ KHÓA
BC+ = BCADE = Q+ => BC LÀ KHÓA

SUY RA: KHÓA CỦA QUAN HỆ Q LÀ A, BC

TẬP CON THỰC SỰ CỦA KHÓA LÀ {B,C}
XÉT B+F = B
    C+F = C
KẾT LUẬN: MỌI THUỘC TÍNH KHÔNG KHÓA D,E ĐỀU PHỤ THUỘC
ĐẦY ĐỦ VÀO KHÓA A VÀ BC. NÊN Q ĐẠT DẠNG CHUẨN 2
	



	







